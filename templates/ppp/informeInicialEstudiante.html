{% extends "/ppp/home.html" %}
{% block titulo %} Informe Inicial (Estudiante) {% endblock %}
{% block contenido %}
<nav style="--bs-breadcrumb-divider: '>'" aria-label="breadcrumb">
    <ol class="breadcrumb" style="padding-bottom: 0px; margin-bottom: -10px;">
        <li class="breadcrumb-item"><a href="{{ url_for('router_main.index') }}">Inicio</a></li>
        <li class="breadcrumb-item"><a href="{{ url_for('router_main.practicas_pre_profesionales') }}">Módulo de Prácticas Pre Profesionales</a></li>
        <li class="breadcrumb-item active">Informe Inicial (Estudiante)</li>
    </ol>
</nav>
<style>
    body {
        overflow: hidden;
    }

    /* Ajuste personalizado de las columnas */
    .col-semana {
        width: 10%;
    }

    .col-fechas {
        width: 20%;
    }

    .col-actividad {
        width: 40%;
    }

    .input-group .form-control {
        width: 50%;
    }

    .row.duracion .col-md-6 {
        display: flex;
        align-items: center;
        justify-content: flex-start;
    }

    .row.duracion .col-md-6 label {
        margin-right: 10px;
    }

    .row.duracion input {
        width: auto;
    }

    .btn-group-opciones {
        display: flex;
        gap: 10px;
    }
</style>
<div class="container-fluid my-4 scrollable">
    <div class="card w-100 ">
        <div class="card-header bg-red-usat text-white">
            Informe Inicial de Prácticas Pre Profesionales (Estudiante)
        </div>
        <div class="card-body ">
            <form action="" method="POST">
                <!-- Datos del Estudiante -->
                <fieldset>
                    <legend>Datos del Estudiante</legend>
                    <div class="row">
                        <div class="col-md-3">
                            <label for="nombre" class="form-label">Nombres:</label>
                            <input type="text" class="form-control" id="nombre" name="nombre" required>
                        </div>
                        <div class="col-md-3">
                            <label for="apellidos" class="form-label">Apellidos:</label>
                            <input type="text" class="form-control" id="apellidos" name="apellidos" required>
                        </div>
                        <div class="col-md-3">
                            <label for="codigo" class="form-label">Código del Estudiante:</label>
                            <input type="text" class="form-control" id="codigo" name="codigo" required>
                        </div>
                        <div class="col-md-3">
                            <label for="semestre" class="form-label">Semestre Académico:</label>
                            <input type="text" class="form-control" id="semestre" name="semestre" required>
                        </div>
                    </div>
                </fieldset>

                <!-- Datos de la Empresa -->
                <fieldset>
                    <legend>Datos de la Empresa/Institución</legend>
                    <div class="row">
                        <div class="col-md-4">
                            <label for="empresa" class="form-label">Razón Social de la Empresa:</label>
                            <input type="text" class="form-control" id="empresa" name="empresa" required>
                        </div>
                        <div class="col-md-4">
                            <label for="responsable" class="form-label">Nombre del Responsable:</label>
                            <input type="text" class="form-control" id="responsable" name="responsable" required>
                        </div>
                        <div class="col-md-4">
                            <label for="cargo" class="form-label">Cargo del Responsable:</label>
                            <input type="text" class="form-control" id="cargo" name="cargo" required>
                        </div>
                    </div>
                </fieldset>

                <!-- Duración de la Práctica y Objetivos en una sola fila -->
                <div class="row">
                    <!-- Duración de la Práctica -->
                    <div class="col-md-6">
                        <fieldset>
                            <legend>Duración de la Práctica</legend>
                            <div class="row duracion">
                                <div class="col-md-6">
                                    <label for="fecha_inicio" class="form-label">Fecha de Inicio:</label>
                                    <input type="date" class="form-control" id="fecha_inicio" name="fecha_inicio" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="fecha_fin" class="form-label">Fecha de Término:</label>
                                    <input type="date" class="form-control" id="fecha_fin" name="fecha_fin" required>
                                </div>
                            </div>
                        </fieldset>
                    </div>

                    <!-- Objetivos de la Práctica -->
                    <div class="col-md-6">
                        <fieldset>
                            <legend>Objetivos de la Práctica</legend>
                            <table class="table table-bordered" id="tabla-objetivos">
                                <thead>
                                    <tr>
                                        <th style="text-align:center">Objetivo</th>
                                        <th style="text-align:center">Opciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><input type="text" class="form-control" name="objetivo[]" placeholder="Objetivo 1" required></td>
                                        <td style="text-align:center">
                                            <div class="btn-group-opciones">
                                                <button type="button" class="btn btn-primary btn-sm" id="agregarObjetivo">Agregar</button>
                                                <button class="btn btn-danger btn-sm" onclick="eliminarFilaObjetivo(this)">Eliminar</button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </fieldset>
                    </div>
                </div>

                <!-- Plan de Trabajo -->
                <fieldset>
                    <legend>Plan de Trabajo</legend>
                    <table class="table table-bordered" id="tabla-plan-trabajo">
                        <thead>
                            <tr>
                                <th class="col-semana" style="text-align:center">N° de Semana</th>
                                <th class="col-fechas" style="text-align:center">Fechas</th>
                                <th class="col-actividad" style="text-align:center">Actividades a realizar</th>
                                <th style="text-align:center">N° de horas</th>
                                <th style="text-align:center">Opciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="text" class="form-control" name="semana[]" placeholder="Semana 1" required></td>
                                <td>
                                    <div class="input-group">
                                        <input type="date" class="form-control" name="fecha_inicio[]" required>
                                        <input type="date" class="form-control" name="fecha_fin[]" required>
                                    </div>
                                </td>
                                <td><input type="text" class="form-control" name="actividad[]" placeholder="Actividad" required></td>
                                <td><input type="number" class="form-control" name="horas[]" placeholder="Horas" required></td>
                                <td style="text-align:center">
                                    <div class="btn-group-opciones">
                                        <button type="button" class="btn btn-primary btn-sm" id="agregarPlanTrabajo">Agregar</button>
                                        <button class="btn btn-danger btn-sm" onclick="eliminarFilaPlan(this)">Eliminar</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </fieldset>

                <button type="submit" class="btn btn-primary">Guardar Informe</button>
            </form>
        </div>
    </div>
</div>

<!-- Scripts de Bootstrap y JQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Script para manejar el agregado dinámico de objetivos y plan de trabajo -->
<script>
    var contadorObjetivos = 2; // Inicia en 2 porque ya hay un objetivo por defecto
    var contadorSemanas = 2; // Inicia en 2 porque ya hay una semana por defecto

    // Función para agregar una nueva fila de objetivo a la tabla
    document.getElementById('agregarObjetivo').addEventListener('click', function() {
        var nuevaFila = `
            <tr>
                <td><input type="text" class="form-control" name="objetivo[]" placeholder="Objetivo ${contadorObjetivos}" required></td>
                <td style="text-align:center">
                    <div class="btn-group-opciones">
                        <button type="button" class="btn btn-primary btn-sm" id="agregarObjetivo">Agregar</button>
                        <button class="btn btn-danger btn-sm" onclick="eliminarFilaObjetivo(this)">Eliminar</button>
                    </div>
                </td>
            </tr>
        `;
        document.querySelector('#tabla-objetivos tbody').insertAdjacentHTML('beforeend', nuevaFila);
        contadorObjetivos++;
    });

    // Función para eliminar una fila de objetivo
    function eliminarFilaObjetivo(btn) {
        var fila = btn.parentNode.parentNode.parentNode;
        fila.parentNode.removeChild(fila);
    }

    // Función para agregar una nueva fila de plan de trabajo a la tabla
    document.getElementById('agregarPlanTrabajo').addEventListener('click', function() {
        var nuevaFila = `
            <tr>
                <td><input type="text" class="form-control" name="semana[]" placeholder="Semana ${contadorSemanas}" required></td>
                <td>
                    <div class="input-group">
                        <input type="date" class="form-control" name="fecha_inicio[]" required>
                        <input type="date" class="form-control" name="fecha_fin[]" required>
                    </div>
                </td>
                <td><input type="text" class="form-control" name="actividad[]" placeholder="Actividad" required></td>
                <td><input type="number" class="form-control" name="horas[]" placeholder="Horas" required></td>
                <td style="text-align:center">
                    <div class="btn-group-opciones">
                        <button type="button" class="btn btn-primary btn-sm" id="agregarPlanTrabajo">Agregar</button>
                        <button class="btn btn-danger btn-sm" onclick="eliminarFilaPlan(this)">Eliminar</button>
                    </div>
                </td>
            </tr>
        `;
        document.querySelector('#tabla-plan-trabajo tbody').insertAdjacentHTML('beforeend', nuevaFila);
        contadorSemanas++;
    });

    // Función para eliminar una fila de plan de trabajo
    function eliminarFilaPlan(btn) {
        var fila = btn.parentNode.parentNode.parentNode;
        fila.parentNode.removeChild(fila);
    }
</script>
{% endblock %}
